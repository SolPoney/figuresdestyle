<div class="min-h-screen bg-dark-bg px-4 py-8" *ngIf="module">
  <div class="max-w-5xl mx-auto">
    <!-- Navigation retour -->
    <nav class="mb-8" role="navigation" aria-label="Fil d'ariane">
      <a
        routerLink="/"
        class="inline-flex items-center text-blue-500 hover:text-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 py-1"
        aria-label="Retour à la page d'accueil"
      >
        <svg
          class="w-5 h-5 mr-2"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M10 19l-7-7m0 0l7-7m-7 7h18"
          />
        </svg>
        <span>Retour à l'accueil</span>
      </a>
    </nav>

    <!-- En-tête du module -->
    <header class="mb-10" role="banner">
      <h1 class="text-4xl md:text-5xl font-bold text-dark-text mb-4">
        Figures de style – {{ module.titre }} – Défi
      </h1>
      <p
        class="text-lg text-dark-textSecondary bg-dark-surface border border-dark-border rounded-lg p-6"
        *ngIf="!module.isRecap"
      >
        Lisez la définition proposée pour chacune des figures de style
        suivantes, puis démontrez votre maîtrise en atteignant un score de 70 %
        à la fin du module.
      </p>
      <p
        class="text-lg text-dark-textSecondary bg-dark-surface border border-dark-border rounded-lg p-6"
        *ngIf="module.isRecap"
      >
        Ce module récapitulatif vous permet de réviser toutes les figures de
        style des modules précédents.
      </p>
    </header>

    <!-- Liste des figures de style -->
    <section
      class="space-y-6 mb-10"
      *ngIf="!module.isRecap && module.figures.length > 0"
      aria-labelledby="figures-title"
    >
      <h2 id="figures-title" class="text-3xl font-bold text-dark-text mb-6">
        Figures de style du module
      </h2>

      <article
        *ngFor="let figure of module.figures; let i = index"
        class="bg-dark-surface border border-dark-border rounded-lg p-6"
      >
        <!-- Si figure est un objet (FigureDeStyle), affiche tout. Sinon, affiche juste le nom -->
        <ng-container *ngIf="isFigureObject(figure); else simpleFigure">
          <h3 class="text-2xl font-bold text-blue-400 mb-3">
            {{ i + 1 }}. {{ $any(figure).nom }}
          </h3>
          <div class="space-y-4">
            <div>
              <h4
                class="text-sm font-semibold text-dark-textSecondary uppercase tracking-wide mb-2"
              >
                Définition
              </h4>
              <p class="text-dark-text text-lg">
                {{ $any(figure).definition }}
              </p>
            </div>
            <div>
              <h4
                class="text-sm font-semibold text-dark-textSecondary uppercase tracking-wide mb-2"
              >
                Exemple
              </h4>
              <p
                class="text-dark-text text-lg italic border-l-4 border-blue-500 pl-4"
              >
                « {{ $any(figure).exemple }} »
              </p>
            </div>
          </div>
        </ng-container>
        <ng-template #simpleFigure>
          <h3 class="text-2xl font-bold text-blue-400 mb-3">
            {{ i + 1 }}. {{ figure }}
          </h3>
        </ng-template>
      </article>
    </section>

    <!-- Bouton commencer l'exercice -->
    <div class="flex justify-center mt-12">
      <a
        [routerLink]="['/exercise', moduleId]"
        class="inline-flex items-center px-8 py-4 bg-green-600 hover:bg-green-700 text-white text-xl font-bold rounded-lg transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-dark-bg"
        [attr.aria-label]="'Commencer l\'exercice du ' + module.titre"
      >
        <span>Commencer l'exercice</span>
        <svg
          class="ml-3 w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"
          />
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
          />
        </svg>
      </a>
    </div>
  </div>
</div>

<!-- Message si module non trouvé -->
<div
  class="min-h-screen bg-dark-bg px-4 py-8 flex items-center justify-center"
  *ngIf="!module"
>
  <div class="text-center">
    <h1 class="text-3xl font-bold text-dark-text mb-4">Module non trouvé</h1>
    <a
      routerLink="/"
      class="inline-flex items-center text-blue-500 hover:text-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-4 py-2"
    >
      <span>Retour à l'accueil</span>
    </a>
  </div>
</div>
